<!-- Tüm Ligi Oynat Butonu -->
<div class="toolbar">
  <button pButton type="button" (click)="playAll()" class="p-button-primary">Tüm Ligi Oynat</button>
</div>

<!-- Maç Sonuçları -->
<h2 class="section-title">{{ currentWeek }}. Hafta Maç Sonuçları</h2>
<ul class="match-results">
  <li *ngFor="let match of currentMatches$ | async">
    <span class="team-name">{{ getTeamName(match.homeTeamId) }}</span>
    <span class="score">{{ match.homeGoals }} - {{ match.awayGoals }}</span>
    <span class="team-name">{{ getTeamName(match.awayTeamId) }}</span>
  </li>
</ul>

<!-- Sonraki Hafta Butonu -->
<div class="toolbar">
  <button pButton type="button" label="Sonraki Hafta" (click)="playNextWeek()" class="p-button-outlined">Sonraki Hafta</button>
</div>

<!-- Takımlar Tablosu -->
<div *ngIf="teams$ | async as teams">
  <p-table [value]="teams" [responsiveLayout]="'scroll'" class="team-table">
    <ng-template pTemplate="header">
      <tr>
        <th>Takım</th>
        <th>O</th>
        <th>G</th>
        <th>B</th>
        <th>M</th>
        <th>Av.</th>
        <th>Puan</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-team>
      <tr
        [ngClass]="{ 'eliminated': championChances.get(team.id) === 0 }"
        [title]="championChances.get(team.id) === 0 ? 'Şampiyonluk şansı kalmadı' : ''"
      >
        <td>{{ team.name }}</td>
        <td>{{ team.matchesPlayed }}</td>
        <td>{{ team.wins }}</td>
        <td>{{ team.draws }}</td>
        <td>{{ team.losses }}</td>
        <td>{{ team.goalDifference }}</td>
        <td>{{ team.points }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<!-- Şampiyonluk Tahminleri -->
<div *ngIf="championPredictions$ | async as predictions">
  <h3 class="section-title">{{ currentWeek }}. Hafta Şampiyonluk Tahminleri</h3>
  <p-table [value]="predictions" class="prediction-table">
    <ng-template pTemplate="header">
      <tr>
        <th>Takım</th>
        <th>Şampiyonluk İhtimali</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-row>
      <tr>
        <td>{{ row.team.name }}</td>
        <td>%{{ row.chance }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<!-- Oynanmış Maçlar Edit Alanı -->
<h3 class="section-title mt-4">Oynanmış Maçları Düzenle</h3>
<div *ngIf="editableMatches$ | async as matches" class="editable-matches">
  <div *ngFor="let match of matches" class="match-edit-row">
    <span class="team-name">{{ getTeamName(match.homeTeamId) }}</span>

    <input
      type="number"
      [(ngModel)]="match.homeGoals"
      class="score-input"
      min="0"
    />

    <span class="dash">-</span>

    <input
      type="number"
      [(ngModel)]="match.awayGoals"
      class="score-input"
      min="0"
    />

    <span class="team-name">{{ getTeamName(match.awayTeamId) }}</span>

    <button
      pButton
      icon="pi pi-check"
      class="p-button-sm p-button-success ml-2"
      (click)="editMatch(match)"
    ></button>
  </div>
</div>
